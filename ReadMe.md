# é‡‘èžAIæ™ºèƒ½åŠ©æ‰‹ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºŽå¤§è¯­è¨€æ¨¡åž‹çš„é‡‘èžèµ„è®¯åˆ†æžå’Œæ™ºèƒ½ç”Ÿæˆç³»ç»Ÿï¼Œé›†æˆäº†æ–°é—»åˆ†æžã€æ–‡ç« ç”Ÿæˆã€ç”¨æˆ·ç”»åƒæž„å»ºã€æ™ºèƒ½èŠå¤©ç­‰å¤šé¡¹AIåŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨çŽ°ä»£åŒ–çš„æŠ€æœ¯æž¶æž„ï¼Œæä¾›é«˜æ•ˆã€æ™ºèƒ½çš„é‡‘èžå†…å®¹æœåŠ¡ã€‚

## ðŸš€ æ ¸å¿ƒåŠŸèƒ½

### ðŸ“° æ™ºèƒ½æ–°é—»åˆ†æž
- **æ–°é—»ä»·å€¼è¯„ä¼°**: å¤šç»´åº¦è¯„ä¼°æ–°é—»çš„æ—¶æ•ˆæ€§ã€é‡è¦åº¦ã€å½±å“èŒƒå›´
- **å†…å®¹ç»“æž„åŒ–**: è‡ªåŠ¨æå–å…³é”®è¦ç´ ã€å…³é”®è¯ã€çƒ­é—¨æ¿å—
- **æ‘˜è¦ç”Ÿæˆ**: ä¸‰æ®µå¼æ‘˜è¦ï¼ˆäº‹å®žé™ˆè¿°+å¸‚åœºè§£è¯»+å½±å“é¢„åˆ¤ï¼‰
- **æ•æ„Ÿä¿¡æ¯å¤„ç†**: è‡ªåŠ¨è¯†åˆ«å¹¶æ˜µç§°åŒ–å¤„ç†æ•æ„Ÿä¿¡æ¯

### ðŸ“ æ™ºèƒ½æ–‡ç« ç”Ÿæˆ
- **æ—©é—´å¿…è¯»**: åŸºäºŽæœ€æ–°èµ„è®¯ç”Ÿæˆæ¯æ—¥é‡‘èžæ—©æŠ¥
- **é€»è¾‘å¤ç›˜**: æ·±åº¦åˆ†æžå¸‚åœºé€»è¾‘å’ŒæŠ•èµ„æœºä¼š
- **ä¸ªæ€§åŒ–å†…å®¹**: åŸºäºŽç”¨æˆ·ç”»åƒå®šåˆ¶åŒ–å†…å®¹ç”Ÿæˆ
- **è´¨é‡è¯„ä¼°**: è‡ªåŠ¨åŒ–æ–‡ç« è´¨é‡è¯„åˆ†å’Œä¼˜åŒ–å»ºè®®

### ðŸ’¬ æ™ºèƒ½èŠå¤©åŠ©æ‰‹
- **RAGå¢žå¼º**: åŸºäºŽæœ¬åœ°å‘é‡æ•°æ®åº“çš„æ£€ç´¢å¢žå¼ºç”Ÿæˆ
- **ä¸Šä¸‹æ–‡è®°å¿†**: æ”¯æŒå¤šè½®å¯¹è¯å’ŒåŽ†å²è®°å½•ç®¡ç†
- **ä¸“ä¸šå›žç­”**: ä¸“æ³¨é‡‘èžé¢†åŸŸçš„ä¸“ä¸šé—®ç­”æœåŠ¡
- **æµå¼è¾“å‡º**: æ”¯æŒå®žæ—¶æµå¼å“åº”

### ðŸ“Š æ•°æ®å¯è§†åŒ–
- **å¸‚åœºæŒ‡æ•°**: å®žæ—¶å±•ç¤ºä¸»è¦è‚¡æŒ‡æ•°æ®å’ŒKçº¿å›¾
- **è¯äº‘åˆ†æž**: çƒ­ç‚¹å…³é”®è¯å¯è§†åŒ–å±•ç¤º
- **ç»Ÿè®¡æŠ¥è¡¨**: ç”¨æˆ·ä½¿ç”¨ç»Ÿè®¡å’Œç³»ç»Ÿæ€§èƒ½ç›‘æŽ§

### ðŸ”„ è‡ªåŠ¨åŒ–ä»»åŠ¡
- **å®šæ—¶ä»»åŠ¡**: æ–°é—»æŠ“å–ã€æ–‡ç« ç”Ÿæˆã€æ•°æ®æ›´æ–°
- **æ¶ˆæ¯æŽ¨é€**: é£žä¹¦æœºå™¨äººè‡ªåŠ¨æŽ¨é€é‡è¦å†…å®¹
- **æ•°æ®åŒæ­¥**: è‡ªåŠ¨åŒ–æ•°æ®å¤„ç†å’Œå­˜å‚¨

## ðŸ›  æŠ€æœ¯æž¶æž„

### åŽç«¯æŠ€æœ¯æ ˆ
- **Webæ¡†æž¶**: FastAPI 0.115.11 + Uvicorn
- **æ•°æ®åº“**: MongoDB 4.11+ (æ”¯æŒå‰¯æœ¬é›†)
- **AIé›†æˆ**: 
  - å¤§è¯­è¨€æ¨¡åž‹API (GLM-4-Flash/OpenAIå…¼å®¹)
  - å‘é‡æ£€ç´¢ (FAISS + SentenceTransformers)
  - æœ¬åœ°RAGèŠå¤©æœåŠ¡
- **ä»»åŠ¡è°ƒåº¦**: APScheduler 3.11.0
- **æ–‡ä»¶å­˜å‚¨**: é˜¿é‡Œäº‘OSS
- **æ¶ˆæ¯æŽ¨é€**: é£žä¹¦æœºå™¨äºº

### å‰ç«¯æŠ€æœ¯æ ˆ
- **åŸºç¡€æŠ€æœ¯**: HTML5 + CSS3 + åŽŸç”ŸJavaScript
- **æ•°æ®å¯è§†åŒ–**: ECharts + è¯äº‘ç»„ä»¶
- **ç•Œé¢è®¾è®¡**: å“åº”å¼å¸ƒå±€ï¼ŒçŽ°ä»£åŒ–UI

### æ ¸å¿ƒä¾èµ–
```
fastapi==0.115.11
uvicorn==0.34.0
pymongo==4.11.2
motor==3.7.0
openai==1.65.3
faiss-cpu==1.8.0
sentence-transformers==2.7.0
torch>=2.0.0,<2.3.0
pandas==2.2.3
numpy>=1.21.0,<2.0.0
APScheduler==3.11.0
loguru==0.7.3
```

## ðŸ“ é¡¹ç›®ç»“æž„

```
new_finance_ai/
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ config/
â”‚   â””â”€â”€ settings.py           # é…ç½®æ–‡ä»¶
â”œâ”€â”€ api/                      # APIæŽ¥å£å±‚
â”‚   â”œâ”€â”€ article.py            # æ–‡ç« ç›¸å…³æŽ¥å£
â”‚   â”œâ”€â”€ chat.py               # èŠå¤©æŽ¥å£
â”‚   â”œâ”€â”€ dashboard.py          # ä»ªè¡¨ç›˜æŽ¥å£
â”‚   â”œâ”€â”€ page.py               # é¡µé¢è·¯ç”±
â”‚   â”œâ”€â”€ post.py               # åŽ†å²å‘æ–‡æŽ¥å£
â”‚   â””â”€â”€ upload.py             # æ–‡ä»¶ä¸Šä¼ æŽ¥å£
â”œâ”€â”€ core/                     # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ article.py            # æ–‡ç« ç”Ÿæˆé€»è¾‘
â”‚   â”œâ”€â”€ event.py              # äº‹ä»¶å¤„ç†é€»è¾‘
â”‚   â”œâ”€â”€ news.py               # æ–°é—»å¤„ç†é€»è¾‘
â”‚   â””â”€â”€ posts.py              # åŽ†å²å‘æ–‡å¤„ç†
â”œâ”€â”€ services/                 # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ chat_service.py       # èŠå¤©æœåŠ¡
â”‚   â”œâ”€â”€ deepseek_processor.py # DeepSeekå¤„ç†å™¨
â”‚   â”œâ”€â”€ llm.py                # LLMæœåŠ¡
â”‚   â”œâ”€â”€ mongodb.py            # MongoDBæœåŠ¡
â”‚   â”œâ”€â”€ vector_service.py     # å‘é‡æ£€ç´¢æœåŠ¡
â”‚   â””â”€â”€ oss_uploader.py       # OSSä¸Šä¼ æœåŠ¡
â”œâ”€â”€ models/                   # æ•°æ®æ¨¡åž‹
â”‚   â”œâ”€â”€ database.py           # æ•°æ®åº“æ¨¡åž‹
â”‚   â””â”€â”€ models.py             # APIæ¨¡åž‹
â”œâ”€â”€ prompt/                   # æç¤ºè¯æ¨¡æ¿
â”‚   â”œâ”€â”€ article.py            # æ–‡ç« ç”Ÿæˆæç¤ºè¯
â”‚   â”œâ”€â”€ event.py              # äº‹ä»¶åˆ†æžæç¤ºè¯
â”‚   â”œâ”€â”€ news.py               # æ–°é—»åˆ†æžæç¤ºè¯
â”‚   â”œâ”€â”€ posts.py              # åŽ†å²å‘æ–‡æç¤ºè¯
â”‚   â””â”€â”€ util.py               # é€šç”¨æç¤ºè¯å·¥å…·
â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ html_parser.py        # HTMLè§£æžå·¥å…·
â”‚   â”œâ”€â”€ task_utils.py         # ä»»åŠ¡å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ time_utils.py         # æ—¶é—´å·¥å…·
â”‚   â””â”€â”€ tools.py              # é€šç”¨å·¥å…·
â”œâ”€â”€ static/                   # é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.html            # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ generate.html         # ç”Ÿæˆé¡µé¢
â”‚   â”œâ”€â”€ styles.css            # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ shared.js             # å…±äº«JS
â”‚   â””â”€â”€ echarts.min.js        # å›¾è¡¨åº“
â”œâ”€â”€ vector_storage/           # å‘é‡å­˜å‚¨
â”‚   â”œâ”€â”€ faiss_index.bin       # FAISSç´¢å¼•æ–‡ä»¶
â”‚   â”œâ”€â”€ metadata.json         # å…ƒæ•°æ®
â”‚   â””â”€â”€ documents.json        # æ–‡æ¡£æ•°æ®
â””â”€â”€ logs/                     # æ—¥å¿—ç›®å½•
```

## âš™ï¸ å®‰è£…é…ç½®

### 1. çŽ¯å¢ƒè¦æ±‚
- Python 3.10+
- MongoDB 4.11+
- 8GB+ RAM (æŽ¨è)

### 2. å®‰è£…ä¾èµ–
```bash
# åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
.\venv\Scripts\activate   # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3. çŽ¯å¢ƒé…ç½®
åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

```ini
# MongoDBé…ç½®
MONGODB_URI=mongodb://ä½ çš„ç”¨æˆ·å:ä½ çš„å¯†ç @ä½ çš„MongoDBåœ°å€:ç«¯å£/admin
MONGODB_DB=ä½ çš„æ•°æ®åº“å

# LLMé…ç½®
LLM_MODEL=GLM-4-Flash
LLM_API_KEY=ä½ çš„LLM_APIå¯†é’¥
LLM_BASE_URL=ä½ çš„LLMæœåŠ¡åœ°å€

# Difyé…ç½® (å¯é€‰)
DIFY_DATASET_API_KEY=ä½ çš„Difyæ•°æ®é›†APIå¯†é’¥
DIFY_DATASET_ID=ä½ çš„Difyæ•°æ®é›†ID
DIFY_BASE_URL=ä½ çš„DifyæœåŠ¡åœ°å€
DIFY_CHAT_API_KEY=ä½ çš„DifyèŠå¤©APIå¯†é’¥

# é£žä¹¦é…ç½® (å¯é€‰)
FEISHU_APP_URL=ä½ çš„é£žä¹¦Webhookåœ°å€

# é˜¿é‡Œäº‘OSSé…ç½® (å¯é€‰)
OSS_ACCESS_KEY_ID=ä½ çš„é˜¿é‡Œäº‘OSS_AccessKey_ID
OSS_ACCESS_KEY_SECRET=ä½ çš„é˜¿é‡Œäº‘OSS_AccessKey_Secret
OSS_ENDPOINT=ä½ çš„OSSæœåŠ¡åœ°å€
OSS_BUCKET_NAME=ä½ çš„OSSå­˜å‚¨æ¡¶åç§°

# è¿›ç¨‹é…ç½®
PROCESS_MAX_WORKERS=4
THREAD_MAX_WORKERS=10
```

### 4. æ•°æ®åº“åˆå§‹åŒ–
ç¡®ä¿MongoDBæœåŠ¡æ­£åœ¨è¿è¡Œï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºæ‰€éœ€çš„é›†åˆã€‚

### 5. å¯åŠ¨æœåŠ¡
```bash
# å¼€å‘æ¨¡å¼å¯åŠ¨
python app.py

# æˆ–ä½¿ç”¨uvicornå¯åŠ¨
uvicorn app:app --host 0.0.0.0 --port 8080 --workers 4
```

è®¿é—® http://localhost:8080 æŸ¥çœ‹ä¸»ç•Œé¢  
è®¿é—® http://localhost:8080/docs æŸ¥çœ‹APIæ–‡æ¡£

## ðŸ“– ä½¿ç”¨æŒ‡å—

### ä¸»è¦åŠŸèƒ½å…¥å£

1. **ä¸»ä»ªè¡¨ç›˜** (`/`)
   - æŸ¥çœ‹å¸‚åœºæŒ‡æ•°å’ŒKçº¿å›¾
   - æµè§ˆæœ€æ–°èµ„è®¯åˆ—è¡¨
   - ç”Ÿæˆæ–‡ç« åŠŸèƒ½

2. **æ–‡ç« ç”Ÿæˆ** (`/generate`)
   - é€‰æ‹©æ–‡ç« ç±»åž‹ï¼ˆæ—©é—´å¿…è¯»/é€»è¾‘å¤ç›˜ï¼‰
   - å®žæ—¶æŸ¥çœ‹ç”Ÿæˆè¿›åº¦
   - é¢„è§ˆå’Œå¯¼å‡ºç”Ÿæˆç»“æžœ

3. **æ™ºèƒ½èŠå¤©** (APIæŽ¥å£)
   - POST `/api/chat` - å‘é€èŠå¤©æ¶ˆæ¯
   - GET `/api/chat/history` - èŽ·å–èŠå¤©åŽ†å²
   - POST `/api/chat/feedback` - æ¶ˆæ¯åé¦ˆ

### APIæŽ¥å£è¯´æ˜Ž

#### æ–‡ç« ç”Ÿæˆ
```http
POST /api/generate
Content-Type: application/json

{
    "article_type": "ReadMorning"  // æˆ– "LogicalReview"
}
```

#### èŠå¤©å¯¹è¯
```http
POST /api/chat
Content-Type: application/json

{
    "message": "è¯·åˆ†æžä¸€ä¸‹å½“å‰å¸‚åœºæƒ…å†µ",
    "conversation_id": "å¯é€‰çš„å¯¹è¯ID",
    "stream": false
}
```

#### èŽ·å–æ–°é—»è¯¦æƒ…
```http
GET /api/news/{news_id}
```

## ðŸ”§ é«˜çº§é…ç½®

### å®šæ—¶ä»»åŠ¡é…ç½®
ç³»ç»Ÿå†…ç½®å¤šä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå¯åœ¨ `scheduler_job.py` ä¸­é…ç½®ï¼š

- **æ–°é—»å¤„ç†**: æ¯2å°æ—¶æ‰§è¡Œ
- **æ–‡ç« ç”Ÿæˆ**: æ¯æ—¥å®šæ—¶ç”Ÿæˆ
- **æ•°æ®åŒæ­¥**: å®šæœŸæ•°æ®æ›´æ–°

### å‘é‡æ•°æ®åº“é…ç½®
- **æ¨¡åž‹**: all-MiniLM-L6-v2 (384ç»´)
- **ç´¢å¼•ç±»åž‹**: FAISS IndexFlatIP
- **å­˜å‚¨è·¯å¾„**: `vector_storage/`

### æ—¥å¿—é…ç½®
- **æ—¥å¿—çº§åˆ«**: INFO
- **æ—¥å¿—ç›®å½•**: `logs/`
- **è½®è½¬ç­–ç•¥**: æŒ‰æ—¥æœŸè½®è½¬

## ðŸš€ éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½² (æŽ¨è)
```dockerfile
FROM python:3.10-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8080

CMD ["python", "app.py"]
```

### ç”Ÿäº§çŽ¯å¢ƒé…ç½®
1. ä½¿ç”¨åå‘ä»£ç† (Nginx)
2. é…ç½®SSLè¯ä¹¦
3. è®¾ç½®çŽ¯å¢ƒå˜é‡
4. é…ç½®æ—¥å¿—æ”¶é›†
5. è®¾ç½®ç›‘æŽ§å‘Šè­¦

## ðŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿæ€§èƒ½
- **å¹¶å‘å¤„ç†**: æ”¯æŒå¤šè¿›ç¨‹/å¤šçº¿ç¨‹
- **ç¼“å­˜ç­–ç•¥**: å‘é‡æ£€ç´¢ç»“æžœç¼“å­˜
- **è¿žæŽ¥æ± **: MongoDBè¿žæŽ¥æ± ä¼˜åŒ–
- **å¼‚æ­¥å¤„ç†**: FastAPIå¼‚æ­¥æ”¯æŒ

### å»ºè®®é…ç½®
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: 8GBä»¥ä¸Š
- **å­˜å‚¨**: SSDç¡¬ç›˜
- **ç½‘ç»œ**: ç¨³å®šçš„ç½‘ç»œè¿žæŽ¥

## ðŸ”’ å®‰å…¨è¯´æ˜Ž

### æ•°æ®å®‰å…¨
- APIå¯†é’¥é€šè¿‡çŽ¯å¢ƒå˜é‡é…ç½®
- æ•°æ®åº“è¿žæŽ¥åŠ å¯†
- ç”¨æˆ·æ•°æ®éš”ç¦»å­˜å‚¨

### è®¿é—®æŽ§åˆ¶
- JWTè®¤è¯æœºåˆ¶
- APIè®¿é—®é¢‘çŽ‡é™åˆ¶
- æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨å¤„ç†

## ðŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æŽ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ðŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ›´æ¢LLMæ¨¡åž‹ï¼Ÿ
A: ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ `LLM_MODEL` å’Œç›¸å…³é…ç½®å³å¯ã€‚

### Q: å‘é‡æ•°æ®åº“å¦‚ä½•è¿ç§»ï¼Ÿ
A: ä½¿ç”¨ `migrate_to_faiss.py` è„šæœ¬è¿›è¡Œæ•°æ®è¿ç§»ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰æç¤ºè¯ï¼Ÿ
A: ä¿®æ”¹ `prompt/` ç›®å½•ä¸‹å¯¹åº”çš„æç¤ºè¯æ–‡ä»¶ã€‚

### Q: ç³»ç»Ÿæ€§èƒ½å¦‚ä½•ä¼˜åŒ–ï¼Ÿ
A: è°ƒæ•´ `config/settings.py` ä¸­çš„è¿›ç¨‹æ± é…ç½®ï¼Œå¢žåŠ æœåŠ¡å™¨èµ„æºã€‚

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

å¦‚æžœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ (`logs/` ç›®å½•)
2. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤æ‰€æœ‰ä¾èµ–æœåŠ¡æ­£å¸¸è¿è¡Œ
4. æäº¤ Issue æè¿°é—®é¢˜è¯¦æƒ…

---

**æ³¨æ„**: è¯·ç¡®ä¿åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­æ­£ç¡®é…ç½®æ‰€æœ‰çŽ¯å¢ƒå˜é‡å’Œå®‰å…¨è®¾ç½®ã€‚
