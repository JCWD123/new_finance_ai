# 早间必读
ContentGenerationSystemPrompt = "金融内容生成引擎"

ContentGenerationPrompt = """
[任务]结构化内容生成：
1.数据驱动生成: 基于文章风格配置、风格参考文章、昨日开收盘价格、新闻素材内容及摘要生成内容，评分决定段落展开深度
2.多维度优化: 
  术语校验: 关联CFA核心术语库确保专业表述
3.智能权重分配:
  评分调整: 根据新闻素材中的评分调整段落展开深度
  篇幅控制: 篇幅控制在1800-2500字之间
4.逻辑分析：根据风格参考文章中对事件分析的逻辑进行逻辑推演
  - 1. 因果溯源层：解析风格参考文章中的事件归因模型（如时间序列归因/因素分解模型），提取其逻辑树构建规则
  - 2. 框架移植层：将参考文章中的分析框架与核心方法论结合，建立论证体系
  - 3. 动态校验层：通过事件影响权重算法实现生成内容事件核心要素展开
  - 4. 逻辑衔接强化：
      - 严格遵循『数据锚点植入-监管脉络梳理-市场异动验证』的CFA标准分析路径
      - 国际事件分析包含跨境资本流动模块
      - 国内段落增加政策效力衰减期的推演

[输入参数]
- 新闻素材：{key_points}
- 昨日开收盘价格：{prices}
- 风格配置：{writing_style}
- 风格参考文章：{reference_contents}

[输入参数解构]
- 核心要点：{{
    "event_summary": "内容摘要",
    "content": "新闻素材内容",
    "score": 这里是新闻素材的评分,
    "date": "新闻/事件发布时间",
}}
- 开收盘价格名称解读：
{{
    "000001.SH": "上证指数",
    "N225.GI": "日经225指数",
    "IXIC.GI": "纳斯达克指数",
}}

[质量控制规范]:
1.内容规范：
- 严格遵循先国际后国内时空序列
- 严格遵循美股 -> 国际其他事件 -> 国内事件的结构
- 严格遵循1800-2500字区间控制
- 严格遵循风格参考文章组织语句，使文章更通俗易懂
{constraint}
- 强制排除以下内容类型：
  - 个人投资经验分享
  - 具体买卖点位建议
  - 金融产品推荐话术
2.逻辑校验：
- 24小时跨市场传导链完整性检测
- 历史估值参照系自动校准功能
- 自媒体舆情影响因子动态加权

[输出格式]
{OutputFormatConstraint}

```json
{{"content": "生成的内容，段落之间使用\\n连接，不使用实际换行符"}}
```
严格遵循JSON格式输出，不要包含任何Markdown代码块或解释性文字
"""

# 质量评估系统
AssessmentQualityStyleMigrationSystemPrompt = "风格迁移质量评估专家"
AssessmentQualityStyleMigrationPrompt = """
[输入要素]
- 新闻素材：{key_points}
- 风格参考文章：{reference_contents}
- 生成内容：{generated_content}

[三维加权评估体系]
1. 内容覆盖度（40%）
   - 要点完整率（20分）
   - 数据准确性（15分）
   - 逻辑自洽性（5分）

2. 风格契合度（50%）
   - 语言特征（25分）
     • 语料混合比（8分）
     • 修辞手法（7分）
     • 人称体系（5分）
     • 标点模式（5分）
   - 结构特征（15分）
     • 段落节奏（6分）
     • 叙事流（5分）
     • 格式元素（4分）
   - 领域特征（10分）
     • 术语体系（6分）
     • 论证方式（4分）

3. 表达规范（10%）
   - 语法正确（6分）
   - 格式合规（4分）

[评估流程]
1. 特征解析阶段：
   - 解构风格参考文章为可量化风格配置参数
2. 内容验证阶段：
   - 要点内容覆盖检查
3. 风格比对阶段：
   - 计算生成内容与风格参数的偏离度：
     ```math
     Deviation = \sum \frac{{|实际值 - 目标值|}}{{允许波动范围}}
     ```

[输出规范]
{OutputFormatConstraint}

```json
{{
  "EvaluationReport": {{
    "ContentDimension": {{
      "Score": 36,
      "CoveredPoints": ["政策影响分析", "技术路线对比"],
      "MissingElements": ["供应链成本数据"],
      "DataDiscrepancies": ["磷酸铁锂占比误差2%"]
    }},
    "StyleDimension": {{
      "Score": 48,
      "FeatureComparisons": [
        {{
          "指标": "人称分布",
          "目标": "第二人称60%",
          "实际": "第二人称45%",
          "影响分": "-2.3"
        }},
        {{
          "指标": "段落节奏",
          "目标": "平均段落长度110字",
          "实际": "平均段落长度158字", 
          "影响分": "-4.1"
        }}
      ]
    }},
    "OverallScore": 89.5,
    "OptimizationPaths": [
      {{
        "类型": "内容补充",
        "建议": "在第三段添加碳酸锂价格走势图表",
        "预期增益": "+3.2分"
      }},
      {{
        "类型": "风格调校", 
        "建议": "增加2处反问句提升互动性",
        "预期增益": "+1.8分"
      }}
    ]
  }}
}}
```
严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""

# 文章字数优化
CallbackCharacter = """
根据内容生成规范，当前输出{{content_length}}字未达标准，请按以下要求优化：
1. 字数控制：严格控制在1800-2500字
2. 增加要点覆盖：优先覆盖评分>85的核心要点,字数不足时可扩展覆盖低评分的核心要点
3. 风格匹配：保持{{writing_style}}风格
4. 风格参考文章{reference_contents},生成内容风格和思维逻辑与风格参考文章保持一致
[约束条件]
{constraint}

[输出格式]
{OutputFormatConstraint}

```json
{{
  "content": "这里是生成的内容"
}}
```

严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""

# 文章质量优化
CallQualityGenrationPrompt = """
根据质量评估报告对生成内容进行精准修改，确保达到以下目标：
1. 对缺失的关键信息进行补充完善，确保内容完整覆盖新闻素材核心要素
2. 调整不符合目标受众认知水平的表述方式，统一正式/非正式语体风格
3. 优化语法结构，消除冗余表达，提升行文流畅度与逻辑严密性
严格遵循以下技术规范：
- 输出内容长度控制在1800-2500汉字区间
- 仅呈现经修改优化的最终文本内容
- 完全排除字数统计、修改说明等附加信息
- 确保JSON语法绝对正确，避免转义字符错误
{constraint}

[输出格式]
{OutputFormatConstraint}

```json
{{
  "content": "这里是生成的内容"
}}
```

严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""

# 逻辑复盘
LogicReviewSystemPrompt = "你是由DeltaEye驱动的金融沙盘推演官，具备三维行情解构能力和多空博弈推演系统。核心职能：1.通过关税梯度表验证市场情绪传导 2.基于量能分水岭构建趋势推演模型 3.运用行为观察矩阵解码资金流向"
LogicReviewPrompt = """
[任务目标]
基于风格参考文章、早间必读文章、今日金融新闻、每日上证指数实时行情，对金融资讯进行逻辑复盘,输出兼具专业性与易读性的逻辑复盘

[输入参数]
- 新闻事件: {events}
- 今日行情: {market_data}
- 早间必读参考文章: {ReadMorning_articles}
- 风格参考文章: {style_reference_article}


[处理流程]
1.【市场情绪验证】
突发政策/谣言传导路径（如关税政策→国产替代异动）
早间观点与实盘走势的契合度（特别是关于仓位管理的警示作用）
量能真实性校验（全市场成交量＞个股对倒可信度）
历史行情映射(如2020年7连阳调整类比)
2.【趋势推演系统】
缺口博弈法则（上下缺口仓位攻防策略）
三面验证原则（基本面＞消息面＞技术面）
假期效应预判（政策真空期防御姿态）
3.【行为观察矩阵】
全球市场联动（中日韩越关税耐受度对比）
4.【动态模型库】
〖关税梯度表〗（基础税率+附加条款拆解）
〖量能分水岭〗（万亿成交情绪转折标记）
〖衰退预警器〗(54%关税持续下的冲击推演）
[表达规范]
行情分析：分析每日行情走势，分析市场情绪
内容要求：沉浸式交易场景还原，政策敏感度分级预警，仓位策略可视化推演，事件参考风格参考文章分析逻辑分析
国际对比：🌏符号引导（中日韩市场异动）
策略提醒：每日仓位纪律播报
历史参照：参照历史对应行情
逻辑表述：语言通畅，减少分点概括式表述，贴合参考风格参考文章
[约束条件]
{constraints}
- 内容通俗易懂，参考风格参考文章进行组织语句
- 字数限制：500字左右
[输出格式]
{OutputFormatConstraint}

```json
{{
  "content": "逻辑复盘内容",
}}
```

严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""

# 文章事件追溯系统
ContentEventTraceSystemPrompt = """你是一位专业的内容追溯与数据校验专家，擅长识别文章中的事件来源并验证数据准确性。你的核心能力包括：
1) 准确识别内容片段与原始事件的对应关系
2) 精确比对数据在转述过程中的准确性
3) 系统化展示数据校验结果
"""

ContentEventTracePrompt = """
[任务目标]
1. 精准标注事件引用关系，确保每个数据点对应原始事件
2. 实现数值型数据的自动化校验与修正
3. 生成标准化的校验报告
4. 输出符合规范的标注文本

[输入参数]
- 待处理文本: {content}（包含多个自然段落的生成内容）
- 事件数据库: {events}（结构化数据集合，包含事件ID、数值字段等）
- 金融行情数据库: {market_data}（包含市场行情、指数数据等，用于实时数据校验）​​

[处理规则]
1. 事件映射标注
   逐句扫描文本，识别以下要素：
    • 市场指标（标普500、COMEX黄金等）→ ​强制关联{market_data}​​和{events}
    • 企业财务数据（英伟达、AMD等）→ 关联{events}
    • 政策声明（关税政策、财政数据等）→ 关联{events}
  对识别出的要素执行双重匹配​：
    → 市场指标需同时匹配{events}事件ID和{market_data}实时行情
    → 同一句子含多个事件时，采用并列标注
    → 标注位置紧接在数据描述之后

2. 数据可靠性验证
   - 建立数据校验矩阵：
     | 文本数据 | 事件ID | 原始值 | ​行情最新值​ | 状态(正确/错误) | 修正值 | 错误类型 |
   - 数值核验规则：
     ① 百分比数值误差范围≤±0.1%
     ② 金额数值必须匹配原始单位（亿/万/美元等）
     ③ 时间范围需精确到季度级别
   - 异常处理流程：
     发现偏差 → 记录错误类型 → 调用修正算法 → 生成替代值

3. 自动化修正引擎
   - 数值替换原则：
     ▸市场数据优先原则​：当{events}与{market_data}冲突时，以{market_data}实时行情为准
     ▸ 维持原始语句结构
     ▸ 保留修辞手法
   - 上下文适配检测：
     ​金融语义校验​：通过FinBERT模型检测修正后的数值是否符合行业表达惯例（例："暴涨10%"需对应≥8%的绝对涨幅）
     通过NLP模型确保修正后的数值与前后文逻辑自洽

[输出格式]
{OutputFormatConstraint}

```json
{{
    "traced_content": "这是添加了事件ID标注并完成数据修正的内容，事件ID标注采用<事件ID>格式。例如：美股科技股昨日大跌，纳指跌幅达5.2%<ea3aa9f0d9bef3e9b93822abb36408bc>",
    "data_verification": [
        {{
            "data": "纳指跌幅5.2%",
            "location": "第1段",
            "source_event": "ea3aa9f0d9bef3e9b93822abb36408bc",
            "verification_result": false,
            "correction": {{
                "original": "纳指跌幅达5.2%",
                "corrected": "纳指跌幅达5.0%",
                "source_data": "根据原始新闻报道的具体数据",
                "context": "包含该数据的完整句子"
            }},
            "note": "数据已修正：原文数值5.2%与源事件数据5.0%不符"
        }}
    ],
    "correction_summary": {{
        "total_data_points": 15,
        "corrected_count": 3,
        "accuracy_rate": "80%"
    }}
}}
```

严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""


# 文章对比系统
ArticleComparisonSystemPrompt = (
    "你是一个专业的文章对比专家，擅长对多篇新闻文章进行多维度对比分析"
)
ArticleComparisonPrompt = """
请对以下两篇文章进行多维度对比分析，要求从写作风格、逻辑结构和核心要点内容三个方面展开，最终输出结构化对比结果。

[输入参数]
- 文章1：{article1}
- 文章2：{article2}

[处理流程]
1. 风格分析
- 分别提取两篇文章的语言特征（如：用词偏好、句式复杂度、修辞手法、情感倾向）
- 判断风格差异（如：学术严谨型 vs 通俗口语化；感性叙事型 vs 理性论证型）
- 举例说明典型句子或段落
2. 逻辑结构拆解
- 绘制两篇文章的框架图（如：总分总、问题-解决、因果链）
- 对比论点展开方式（如：数据支撑型 vs 案例故事型；演绎推理 vs 归纳总结）
- 分析段落衔接与过渡技巧
3. 要点内容对比
- 提炼两篇文章的核心观点与次级论点
- 对比论据选择差异（如：是否使用权威引用、历史案例、统计数据）
- 标注观点重合度与分歧点
4. 总结差异与启示
- 呈现三方面对比结论（风格/逻辑/内容）
- 指出更适合目标读者的文章及原因
- 避免主观臆断，需引用原文证据

[输出格式]
{OutputFormatConstraint}

```json
{{
  "style_analysis": "风格分析结果",
  "logic_analysis": "逻辑结构分析结果",
  "content_analysis": "内容分析结果",
  "conclusion": "总结差异与启示"
}}
```

严格遵循JSON格式输出,直接返回有效JSON对象，不要包含任何Markdown代码块或解释性文字
"""
